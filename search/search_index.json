{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Deploy Localhost python -m mkdocs serve Github Pages python -m mkdocs gh-deploy URL MyDocs Cheatseets Markdown Markdown","title":"Home"},{"location":"#deploy","text":"","title":"Deploy"},{"location":"#localhost","text":"python -m mkdocs serve","title":"Localhost"},{"location":"#github-pages","text":"python -m mkdocs gh-deploy","title":"Github Pages"},{"location":"#url","text":"MyDocs","title":"URL"},{"location":"#cheatseets","text":"","title":"Cheatseets"},{"location":"#markdown","text":"Markdown","title":"Markdown"},{"location":"aws/compute/ec2/","text":"AMI Create EC2 EBS Backed Launch an instance Connect to your instance and customize it Stop Instances (stopping the instance ensures data integrity of the instance; a snapshot will be taken of the instance) Create the image Bundle it (use bundle command in console) AWS automatically registers it for you EC2 Instance store Launch an instance Connect to your instance and customize it Bundle it (Consists of an image manifest -image.manifest.xml- and files -image.part.xx-) Upload the bundle to S3 bucket Register AMI Snapshots Restore Read all blocks to eliminate penalty in production sudo dd if=/dev/xvdf of=/dev/null bs=1M # Or sudo fio \u2013filename=/dev/xvdf \u2013rw=read \u2013bs=128k \u2013iodepth=32 \u2013ioengine=libaio \u2013direct=1 \u2013name=volume-initialize","title":"EC2"},{"location":"aws/compute/ec2/#ami","text":"","title":"AMI"},{"location":"aws/compute/ec2/#create","text":"EC2 EBS Backed Launch an instance Connect to your instance and customize it Stop Instances (stopping the instance ensures data integrity of the instance; a snapshot will be taken of the instance) Create the image Bundle it (use bundle command in console) AWS automatically registers it for you EC2 Instance store Launch an instance Connect to your instance and customize it Bundle it (Consists of an image manifest -image.manifest.xml- and files -image.part.xx-) Upload the bundle to S3 bucket Register AMI","title":"Create"},{"location":"aws/compute/ec2/#snapshots","text":"","title":"Snapshots"},{"location":"aws/compute/ec2/#restore","text":"Read all blocks to eliminate penalty in production sudo dd if=/dev/xvdf of=/dev/null bs=1M # Or sudo fio \u2013filename=/dev/xvdf \u2013rw=read \u2013bs=128k \u2013iodepth=32 \u2013ioengine=libaio \u2013direct=1 \u2013name=volume-initialize","title":"Restore"},{"location":"aws/deployment/cloudformation/","text":"Troubleshooting WaitCondition If WaitCondition times out or returns an error. There is an error in your cloudformation::init code Analyze cfn-init.log and cfn-wire.log for details collect logs via CloudWatch logs \u2013on-failure DO_NOTHING to keep instance from rolling back so you can log in and examine the logs Most common error: URLs for referenced resources (scripts, MSIs, etc.) are returning HTTP 403 or 404 errors","title":"Cloudformation"},{"location":"aws/deployment/cloudformation/#troubleshooting","text":"","title":"Troubleshooting"},{"location":"aws/deployment/cloudformation/#waitcondition","text":"If WaitCondition times out or returns an error. There is an error in your cloudformation::init code Analyze cfn-init.log and cfn-wire.log for details collect logs via CloudWatch logs \u2013on-failure DO_NOTHING to keep instance from rolling back so you can log in and examine the logs Most common error: URLs for referenced resources (scripts, MSIs, etc.) are returning HTTP 403 or 404 errors","title":"WaitCondition"},{"location":"aws/networking/vpc/","text":"Bastion Host High Availability Create 2 bastion hosts in different subnets. Create dns entry in Route53 which uses round robin dns and points to each instance. Tell your sysdamins to connect using the new dns entry EC2 Auto-recovery - If fails, will be recreate Autoscaling group of MAX =1 and MIN = 1. So if the bastion fails it is recreated automatically VPC Flow Logs Traffic Not Logged Traffic generated by instances when contact the Amazon DNS server (if use own dns, so all that traffic is logged) Traffic generated by a windows instance for Amazon windows license activation Traffic to and from 169.254.169.254 for instance metadata DHCP traffic Traffic to the reserved IP address for the default VPC router Troubleshooting Instances cannot communicate If instances in subnets cannot communicate with one another Verify that it is a network issue, not an instance issue Check network ACLs If enable, check VPC flow Logs Nat Configuration Nat Instance and Nat Gateway - Check Route table Association Nat Instance - Check to see if the source/Dest check is disabled Ensure that NAT has masquerade configured, Restart NAT, check the inbound security Group rules If you cannot reach resources in a peered network: Peering request approval Route table configuration Check network ACLs: are you forbidding all external traffic Check security Group configurations on resources Use Cidr block rules in VPC A to allow Access from VPC B If you are not seeing network traffic flow on the AWS side of your VPN connection to your Amazon VPC. Turn on route propagation in the Amazon VPC\u2019s main routing table.","title":"VPC"},{"location":"aws/networking/vpc/#bastion-host","text":"","title":"Bastion Host"},{"location":"aws/networking/vpc/#high-availability","text":"Create 2 bastion hosts in different subnets. Create dns entry in Route53 which uses round robin dns and points to each instance. Tell your sysdamins to connect using the new dns entry EC2 Auto-recovery - If fails, will be recreate Autoscaling group of MAX =1 and MIN = 1. So if the bastion fails it is recreated automatically","title":"High Availability"},{"location":"aws/networking/vpc/#vpc-flow-logs","text":"","title":"VPC Flow Logs"},{"location":"aws/networking/vpc/#traffic-not-logged","text":"Traffic generated by instances when contact the Amazon DNS server (if use own dns, so all that traffic is logged) Traffic generated by a windows instance for Amazon windows license activation Traffic to and from 169.254.169.254 for instance metadata DHCP traffic Traffic to the reserved IP address for the default VPC router","title":"Traffic Not Logged"},{"location":"aws/networking/vpc/#troubleshooting","text":"","title":"Troubleshooting"},{"location":"aws/networking/vpc/#instances-cannot-communicate","text":"If instances in subnets cannot communicate with one another Verify that it is a network issue, not an instance issue Check network ACLs If enable, check VPC flow Logs","title":"Instances cannot communicate"},{"location":"aws/networking/vpc/#nat-configuration","text":"Nat Instance and Nat Gateway - Check Route table Association Nat Instance - Check to see if the source/Dest check is disabled Ensure that NAT has masquerade configured, Restart NAT, check the inbound security Group rules If you cannot reach resources in a peered network:","title":"Nat Configuration"},{"location":"aws/networking/vpc/#peering-request-approval","text":"Route table configuration Check network ACLs: are you forbidding all external traffic Check security Group configurations on resources Use Cidr block rules in VPC A to allow Access from VPC B If you are not seeing network traffic flow on the AWS side of your VPN connection to your Amazon VPC. Turn on route propagation in the Amazon VPC\u2019s main routing table.","title":"Peering request approval"},{"location":"aws/storage/ebs/","text":"Root Volumes Resize Manual method Create a snapshot of the current root volume Create a new volume from the snapshot with new storage specifications Select larger \"size\", thus increasing IOPS Must select the same availability zone as the source Stop the Instance Detach the original root volume Attach the new volume to the instance at same mount point (xvda) \"Automated\" method We can replace the launch configuration of an Auto Scaling Group In a true 3-tier application that is decoupled, we should then be able to terminate instances one by one to recreate them using new configuration Note: If the size of the volume was modified, extend the volume's file system to take advantage of the increased storage capacity","title":"EBS"},{"location":"aws/storage/ebs/#root-volumes","text":"","title":"Root Volumes"},{"location":"aws/storage/ebs/#resize","text":"Manual method Create a snapshot of the current root volume Create a new volume from the snapshot with new storage specifications Select larger \"size\", thus increasing IOPS Must select the same availability zone as the source Stop the Instance Detach the original root volume Attach the new volume to the instance at same mount point (xvda) \"Automated\" method We can replace the launch configuration of an Auto Scaling Group In a true 3-tier application that is decoupled, we should then be able to terminate instances one by one to recreate them using new configuration Note: If the size of the volume was modified, extend the volume's file system to take advantage of the increased storage capacity","title":"Resize"},{"location":"elk/admin/","text":"Deploy Docker-compose git clone https://github.com/maxyermayank/docker-compose-elasticsearch-kibana Know Errors Max virtual memory Desc: Max virtual memory areas vm.max_map_count [65530] likely too low, increase to at least [262144] sudo sysctl -w vm.max_map_count=262144 Forbidden Index x-read-only-allow-delete-api Link PUT .kibana/_settings { \"index\": { \"blocks\": { \"read_only_allow_delete\": \"false\" } } }","title":"Administration"},{"location":"elk/admin/#deploy","text":"","title":"Deploy"},{"location":"elk/admin/#docker-compose","text":"git clone https://github.com/maxyermayank/docker-compose-elasticsearch-kibana","title":"Docker-compose"},{"location":"elk/admin/#know-errors","text":"","title":"Know Errors"},{"location":"elk/admin/#max-virtual-memory","text":"Desc: Max virtual memory areas vm.max_map_count [65530] likely too low, increase to at least [262144] sudo sysctl -w vm.max_map_count=262144","title":"Max virtual memory"},{"location":"elk/admin/#forbidden-index-x-read-only-allow-delete-api","text":"Link PUT .kibana/_settings { \"index\": { \"blocks\": { \"read_only_allow_delete\": \"false\" } } }","title":"Forbidden Index x-read-only-allow-delete-api"},{"location":"elk/beats/","text":"Beats Creating Custom Creating New Beat Examples Know Errors bash: mage: command not found Use vendoring We recommend to use vendoring for your beat. This means the dependencies are put into your beat folder. The beats team currently uses govendor for vendoring. govendor init govendor update +e This will create a directory vendor inside your repository. To make sure all dependencies for the Makefile commands are loaded from the vendor directory, find the following line in your Makefile: ES_BEATS=${GOPATH}/src/github.com/elastic/beats Replace it with: ES_BEATS=./vendor/github.com/elastic/beats To Fetch: govendor fetch github.com/vmware/govmomi/^ +out","title":"Beats"},{"location":"elk/beats/#beats","text":"","title":"Beats"},{"location":"elk/beats/#creating-custom","text":"Creating New Beat Examples","title":"Creating Custom"},{"location":"elk/beats/#know-errors","text":"bash: mage: command not found","title":"Know Errors"},{"location":"elk/beats/#use-vendoring","text":"We recommend to use vendoring for your beat. This means the dependencies are put into your beat folder. The beats team currently uses govendor for vendoring. govendor init govendor update +e This will create a directory vendor inside your repository. To make sure all dependencies for the Makefile commands are loaded from the vendor directory, find the following line in your Makefile: ES_BEATS=${GOPATH}/src/github.com/elastic/beats Replace it with: ES_BEATS=./vendor/github.com/elastic/beats To Fetch: govendor fetch github.com/vmware/govmomi/^ +out","title":"Use vendoring"},{"location":"elk/kibana/","text":"Time Series Filters performancemanager.virtualmachines.metric.info.metric: \"cpu.usagemhz.average\" AND NOT performancemanager.virtualmachines.metric.sample.instance: \"*\" AND performancemanager.hosts.metric.sample.instance: \"*\" Timelion Expression .es(index=vspherebeat-emp-imopolis-*, timefield=performancemanager.datastoresclusters.metric.sample.timestamp, metric=sum:performancemanager.datastoresclusters.metric.sample.value,q=\"performancemanager.datastoresclusters.metric.info.metric: disk.provisioned.latest\").divide(1000000000).label(\"Disk Provisioned [TB]\").color(black).lines(fill=1,width=2).title(\"Capacity Assessment\"), .es(index=vspherebeat-emp-imopolis-*, timefield=performancemanager.datastoresclusters.metric.sample.timestamp, metric=sum:performancemanager.datastoresclusters.metaData.Storage.Capacity,q=\"performancemanager.datastoresclusters.metric.info.metric: disk.provisioned.latest\").divide(1000000000000).label(\"Total Capacity [TB]\").color(yellow).lines(fill=2,width=2), .es(index=vspherebeat-emp-imopolis-*, timefield=performancemanager.datastoresclusters.metric.sample.timestamp, metric=sum:performancemanager.datastoresclusters.metric.sample.value,q=\"performancemanager.datastoresclusters.metric.info.metric: disk.used.latest\").divide(1000000000).label(\"Disk Used [TB]\").color(green).lines(fill=3,width=1), .es(index=vspherebeat-emp-imopolis-*, timefield=performancemanager.datastoresclusters.metric.sample.timestamp, metric=sum:performancemanager.datastoresclusters.metaData.Storage.Capacity,q=\"performancemanager.datastoresclusters.metric.info.metric: disk.provisioned.latest\").divide(1000000000000).multiply(1.1).label(\"Provisioning Threshold [TB]\").color(red).lines(fill=0,width=3),","title":"Kibana"},{"location":"elk/kibana/#time-series","text":"","title":"Time Series"},{"location":"elk/kibana/#filters","text":"performancemanager.virtualmachines.metric.info.metric: \"cpu.usagemhz.average\" AND NOT performancemanager.virtualmachines.metric.sample.instance: \"*\" AND performancemanager.hosts.metric.sample.instance: \"*\"","title":"Filters"},{"location":"elk/kibana/#timelion","text":"","title":"Timelion"},{"location":"elk/kibana/#expression","text":".es(index=vspherebeat-emp-imopolis-*, timefield=performancemanager.datastoresclusters.metric.sample.timestamp, metric=sum:performancemanager.datastoresclusters.metric.sample.value,q=\"performancemanager.datastoresclusters.metric.info.metric: disk.provisioned.latest\").divide(1000000000).label(\"Disk Provisioned [TB]\").color(black).lines(fill=1,width=2).title(\"Capacity Assessment\"), .es(index=vspherebeat-emp-imopolis-*, timefield=performancemanager.datastoresclusters.metric.sample.timestamp, metric=sum:performancemanager.datastoresclusters.metaData.Storage.Capacity,q=\"performancemanager.datastoresclusters.metric.info.metric: disk.provisioned.latest\").divide(1000000000000).label(\"Total Capacity [TB]\").color(yellow).lines(fill=2,width=2), .es(index=vspherebeat-emp-imopolis-*, timefield=performancemanager.datastoresclusters.metric.sample.timestamp, metric=sum:performancemanager.datastoresclusters.metric.sample.value,q=\"performancemanager.datastoresclusters.metric.info.metric: disk.used.latest\").divide(1000000000).label(\"Disk Used [TB]\").color(green).lines(fill=3,width=1), .es(index=vspherebeat-emp-imopolis-*, timefield=performancemanager.datastoresclusters.metric.sample.timestamp, metric=sum:performancemanager.datastoresclusters.metaData.Storage.Capacity,q=\"performancemanager.datastoresclusters.metric.info.metric: disk.provisioned.latest\").divide(1000000000000).multiply(1.1).label(\"Provisioning Threshold [TB]\").color(red).lines(fill=0,width=3),","title":"Expression"},{"location":"elk/queries/","text":"Cluster Health GET /_cluster/health Allocation Errors Explain GET /_cluster/allocation/explain Nodes Stats GET /_nodes/stats Indices List GET /_cat/indices?v List with selected Column GET /_cat/indices?h=creation.date.string Create POST /{index}/_open Close POST /_all/_close Search All GET /vspherebeat/_search { \"query\": { \"match_all\": {} } } Field Match string GET /vspherebeat/_search { \"query\": { \"match\" : { \"performancemanager.hosts.metaData.name\": \"nsvwsdv001.mngt.local\" } } } Field doesn't match string GET /vspherebeat/_search { \"query\": { \"bool\": { \"must_not\": [ { \"match\": { \"performancemanager.virtualmachines.metaData.name\": \"WSTPMNGT007\" } } ] } } } Bool Query (Match and Not Match) GET /vspherebeat/_search { \"query\": { \"bool\": { \"must\": [ { \"match\": { \"performancemanager.virtualmachines.metaData.name\": \"APM-Server\" } }, { \"match\": { \"performancemanager.virtualmachines.metric.info.metric\": \"cpu.usage.average\" } } ], \"must_not\": [ { \"match\": { \"performancemanager.virtualmachines.metric.sample.instance\": \"*\" } } ] } } } Exists Specified Field GET /vspherebeat/_search { \"query\": { \"exists\": { \"field\": \"performancemanager.hosts\" } } } Unique Values from a field GET vspherebeat/_search { \"size\":\"0\", \"aggs\" : { \"uniq_hotsr\" : { \"terms\" : { \"field\" : \"performancemanager.hosts.metaData.name\" } } } } Total of unique values from a field GET /vspherebeat/_search { \"size\" : 0, \"aggs\" : { \"distinct_hots\" : { \"cardinality\" : { \"field\" : \"performancemanager.hosts.metaData.name\" } } } } Help Get Indices Columns GET /_cat/indices?help","title":"ESQueries"},{"location":"elk/queries/#cluster","text":"","title":"Cluster"},{"location":"elk/queries/#health","text":"GET /_cluster/health","title":"Health"},{"location":"elk/queries/#allocation-errors-explain","text":"GET /_cluster/allocation/explain","title":"Allocation Errors Explain"},{"location":"elk/queries/#nodes","text":"","title":"Nodes"},{"location":"elk/queries/#stats","text":"GET /_nodes/stats","title":"Stats"},{"location":"elk/queries/#indices","text":"","title":"Indices"},{"location":"elk/queries/#list","text":"GET /_cat/indices?v","title":"List"},{"location":"elk/queries/#list-with-selected-column","text":"GET /_cat/indices?h=creation.date.string","title":"List with selected Column"},{"location":"elk/queries/#create","text":"POST /{index}/_open","title":"Create"},{"location":"elk/queries/#close","text":"POST /_all/_close","title":"Close"},{"location":"elk/queries/#search","text":"","title":"Search"},{"location":"elk/queries/#all","text":"GET /vspherebeat/_search { \"query\": { \"match_all\": {} } }","title":"All"},{"location":"elk/queries/#field-match-string","text":"GET /vspherebeat/_search { \"query\": { \"match\" : { \"performancemanager.hosts.metaData.name\": \"nsvwsdv001.mngt.local\" } } }","title":"Field Match string"},{"location":"elk/queries/#field-doesnt-match-string","text":"GET /vspherebeat/_search { \"query\": { \"bool\": { \"must_not\": [ { \"match\": { \"performancemanager.virtualmachines.metaData.name\": \"WSTPMNGT007\" } } ] } } }","title":"Field doesn't match string"},{"location":"elk/queries/#bool-query-match-and-not-match","text":"GET /vspherebeat/_search { \"query\": { \"bool\": { \"must\": [ { \"match\": { \"performancemanager.virtualmachines.metaData.name\": \"APM-Server\" } }, { \"match\": { \"performancemanager.virtualmachines.metric.info.metric\": \"cpu.usage.average\" } } ], \"must_not\": [ { \"match\": { \"performancemanager.virtualmachines.metric.sample.instance\": \"*\" } } ] } } }","title":"Bool Query (Match and Not Match)"},{"location":"elk/queries/#exists-specified-field","text":"GET /vspherebeat/_search { \"query\": { \"exists\": { \"field\": \"performancemanager.hosts\" } } }","title":"Exists Specified Field"},{"location":"elk/queries/#unique-values-from-a-field","text":"GET vspherebeat/_search { \"size\":\"0\", \"aggs\" : { \"uniq_hotsr\" : { \"terms\" : { \"field\" : \"performancemanager.hosts.metaData.name\" } } } }","title":"Unique Values from a field"},{"location":"elk/queries/#total-of-unique-values-from-a-field","text":"GET /vspherebeat/_search { \"size\" : 0, \"aggs\" : { \"distinct_hots\" : { \"cardinality\" : { \"field\" : \"performancemanager.hosts.metaData.name\" } } } }","title":"Total of unique values from a field"},{"location":"elk/queries/#help","text":"","title":"Help"},{"location":"elk/queries/#get-indices-columns","text":"GET /_cat/indices?help","title":"Get Indices Columns"},{"location":"elk/snapshotsAndRestore/","text":"Snapshot Config Change parameter in elastic search config file for all nodes The path.repo needs to be a shared folder beetween the cluster path.repo: [\"/usr/share/elasticsearch/snapshots\"] Create PUT /_snapshot/{repository}/{snapshot}?wait_for_completion=true List all Snapshots from a repo GET /_cat/snapshots/{repository}?v&s=id Delete DELETE /_snapshot/{repository}/{snapshot} Repositories Create PUT /_snapshot/my_backup { \"type\": \"fs\", \"settings\": { \"location\": \"/usr/share/elasticsearch/snapshots/backup\" } } List GET /_cat/repositories?v GET /_snapshot/_all Delete DELETE /_snapshot/{repository} Restore Restore - Official Doc Restore From Snapshot POST /_snapshot/{repository}/{snapshot}/_restore","title":"Snapshots&Restore"},{"location":"elk/snapshotsAndRestore/#snapshot","text":"","title":"Snapshot"},{"location":"elk/snapshotsAndRestore/#config","text":"Change parameter in elastic search config file for all nodes The path.repo needs to be a shared folder beetween the cluster path.repo: [\"/usr/share/elasticsearch/snapshots\"]","title":"Config"},{"location":"elk/snapshotsAndRestore/#create","text":"PUT /_snapshot/{repository}/{snapshot}?wait_for_completion=true","title":"Create"},{"location":"elk/snapshotsAndRestore/#list-all-snapshots-from-a-repo","text":"GET /_cat/snapshots/{repository}?v&s=id","title":"List all Snapshots from a repo"},{"location":"elk/snapshotsAndRestore/#delete","text":"DELETE /_snapshot/{repository}/{snapshot}","title":"Delete"},{"location":"elk/snapshotsAndRestore/#repositories","text":"","title":"Repositories"},{"location":"elk/snapshotsAndRestore/#create_1","text":"PUT /_snapshot/my_backup { \"type\": \"fs\", \"settings\": { \"location\": \"/usr/share/elasticsearch/snapshots/backup\" } }","title":"Create"},{"location":"elk/snapshotsAndRestore/#list","text":"GET /_cat/repositories?v GET /_snapshot/_all","title":"List"},{"location":"elk/snapshotsAndRestore/#delete_1","text":"DELETE /_snapshot/{repository}","title":"Delete"},{"location":"elk/snapshotsAndRestore/#restore","text":"Restore - Official Doc","title":"Restore"},{"location":"elk/snapshotsAndRestore/#restore-from-snapshot","text":"POST /_snapshot/{repository}/{snapshot}/_restore","title":"Restore From Snapshot"},{"location":"unix/commands/disks/","text":"Disks Lists block devices lsblk fdisk -l Create ext4 Filesystem Can use parted command # lsblk NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT loop0 7:0 0 88.5M 1 loop /snap/core/7270 loop1 7:1 0 18M 1 loop /snap/amazon-ssm-agent/1455 xvda 202:0 0 8G 0 disk \u2514\u2500xvda1 202:1 0 8G 0 part / xvdf 202:80 0 8G 0 disk # fdisk /dev/xvdf Command (m for help): n => Create Partition Partition type: p primary (0 primary, 0 extended, 4 free) e extended Command (m for help): p => Print partition Command (m for help): w => Write # mkfs -L projectA -t ext4 /dev/xvdf1 # Format Partition and create label # mkdir /mnt/ProjectA # mount /dev/xvdf1 /mnt/ProjectA/ # vi /etc/fstab LABEL=projectA /mnt/ProjectA/ ext4 defaults 0 0 # Add This Line umount /mnt/ProjectA/ Create Swap Partition Can use parted command # fdisk /dev/xvdf Welcome to fdisk (util-linux 2.31.1). Changes will remain in memory only, until you decide to write them. Be careful before using the write command. Command (m for help): p Disk /dev/xvdf: 8 GiB, 8589934592 bytes, 16777216 sectors Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disklabel type: dos Disk identifier: 0xaef5270b Device Boot Start End Sectors Size Id Type /dev/xvdf1 2048 4196351 4194304 2G 82 Linux swap / Solaris /dev/xvdf2 4196352 10487807 6291456 3G 83 Linux /dev/xvdf3 10487808 16777215 6289408 3G 5 Extended /dev/xvdf5 10489856 12587007 2097152 1G 83 Linux /dev/xvdf6 12589056 14686207 2097152 1G 83 Linux /dev/xvdf7 14688256 16777215 2088960 1020M 83 Linux Command (m for help): t Partition number (1-3,5-7, default 7): 1 Hex code (type L to list all codes): 82 Command (m for help): w # mkswap /dev/xvdf1 # swapon /dev/xvdf1 # to shutoff -> swapoff /dev/xvdf2 # free -m # vi /etc/fstab UUID=99fd52d5-e821-45a5-9366-30666046406f swap swap default 0 0 Create LVM Filesystem # fdisk /dev/xvdf Welcome to fdisk (util-linux 2.31.1). Changes will remain in memory only, until you decide to write them. Be careful before using the write command. Command (m for help): p Disk /dev/xvdf: 8 GiB, 8589934592 bytes, 16777216 sectors Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disklabel type: dos Disk identifier: 0xaef5270b Device Boot Start End Sectors Size Id Type /dev/xvdf1 2048 4196351 4194304 2G 82 Linux swap / Solaris /dev/xvdf2 4196352 10487807 6291456 3G 83 Linux /dev/xvdf3 10487808 16777215 6289408 3G 5 Extended /dev/xvdf5 10489856 12587007 2097152 1G 83 Linux /dev/xvdf6 12589056 14686207 2097152 1G 83 Linux /dev/xvdf7 14688256 16777215 2088960 1020M 83 Linux Command (m for help): t Partition number (1-3,5-7, default 7): 2 Hex code (type L to list all codes): 8e Changed type of partition 'Linux' to 'Linux LVM'. Command (m for help): w The partition table has been altered. Syncing disks. # fdisk /dev/xvdf Welcome to fdisk (util-linux 2.31.1). Changes will remain in memory only, until you decide to write them. Be careful before using the write command. Command (m for help): p Disk /dev/xvdf: 8 GiB, 8589934592 bytes, 16777216 sectors Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disklabel type: dos Disk identifier: 0xaef5270b Device Boot Start End Sectors Size Id Type /dev/xvdf1 2048 4196351 4194304 2G 82 Linux swap / Solaris /dev/xvdf2 4196352 10487807 6291456 3G 8e Linux LVM /dev/xvdf3 10487808 16777215 6289408 3G 5 Extended /dev/xvdf5 10489856 12587007 2097152 1G 83 Linux /dev/xvdf6 12589056 14686207 2097152 1G 83 Linux /dev/xvdf7 14688256 16777215 2088960 1020M 83 Linux Command (m for help): t Partition number (1-3,5-7, default 7): 5 Hex code (type L to list all codes): 8e Changed type of partition 'Linux' to 'Linux LVM'. Command (m for help): w The partition table has been altered. Syncing disks. # pvcreate /dev/xvdf2 Physical volume \"/dev/xvdf2\" successfully created. # pvcreate /dev/xvdf5 Physical volume \"/dev/xvdf5\" successfully created. # vgcreate VG1 /dev/xvdf2 /dev/xvdf5 Volume group \"VG1\" successfully created root@ip-172-31-81-196:~# vgdisplay /dev/VG1 --- Volume group --- VG Name VG1 System ID Format lvm2 Metadata Areas 2 Metadata Sequence No 1 VG Access read/write VG Status resizable MAX LV 0 Cur LV 0 Open LV 0 Max PV 0 Cur PV 2 Act PV 2 VG Size 3.99 GiB PE Size 4.00 MiB Total PE 1022 Alloc PE / Size 0 / 0 Free PE / Size 1022 / 3.99 GiB VG UUID ELopyA-2vai-XuiQ-vm7M-RF9q-k0ve-yUeXM6 # lvcreate VG1 -L +3.9G -n LV1 Rounding up size to full physical extent 3.90 GiB Logical volume \"LV1\" created. root@ip-172-31-81-196:~# lvdisplay --- Logical volume --- LV Path /dev/VG1/LV1 LV Name LV1 VG Name VG1 LV UUID Q0mXgw-q9E7-ncuH-Vv2t-NTqx-epn9-3EK3DH LV Write Access read/write LV Creation host, time ip-172-31-81-196, 2019-08-02 21:45:49 +0000 LV Status available # open 0 LV Size 3.90 GiB Current LE 999 Segments 2 Allocation inherit Read ahead sectors auto - currently set to 256 Block device 253:0 # mkfs.ext4 /dev/VG1/LV1 mke2fs 1.44.1 (24-Mar-2018) Creating filesystem with 1022976 4k blocks and 256000 inodes Filesystem UUID: 3cc6d97e-a315-4051-a572-16e06bf9c9f9 Superblock backups stored on blocks: 32768, 98304, 163840, 229376, 294912, 819200, 884736 Allocating group tables: done Writing inode tables: done Creating journal (16384 blocks): done Writing superblocks and filesystem accounting information: done root@ip-172-31-81-196:~# mkdir /mnt/LV1-mount root@ip-172-31-81-196:~# mount /dev/VG1/LV1 /mnt/LV1-mount root@ip-172-31-81-196:~# vi /etc/fstab /dev/VG1/LV1 /mnt/LV1-mount ext4 defaults 0 0 # Add This Line # Can edit first the /etc/fsatab file and after do mount -a (mount everything in /etc/fstab file) instead mount command Share Disk Install NFS yum install -y nfs-utils systemctl enable nfs systemctl start nfs Master Configure Export /snapshots is a filestem from nfs type # vi /etc/exports /snapshots *(rw) => Add Line # exportfs /snapshots <world> Enable Service firewall-cmd --add-service nfs --permanent firewall-cmd --permanent --add-service=rpc-bind firewall-cmd --permanent --add-service=mountd firewall-cmd --permanent --add-port=2049/tcp firewall-cmd --permanent --add-port=2049/udp firewall-cmd --reload Slaves # vi /etc/fstab 10.240.100.18:/snapshots /elastic/snapshots nfs _netdev,rw 0 0 # mount -a # mount | grep elastic","title":"Disks"},{"location":"unix/commands/disks/#disks","text":"Lists block devices lsblk fdisk -l","title":"Disks"},{"location":"unix/commands/disks/#create-ext4-filesystem","text":"Can use parted command # lsblk NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT loop0 7:0 0 88.5M 1 loop /snap/core/7270 loop1 7:1 0 18M 1 loop /snap/amazon-ssm-agent/1455 xvda 202:0 0 8G 0 disk \u2514\u2500xvda1 202:1 0 8G 0 part / xvdf 202:80 0 8G 0 disk # fdisk /dev/xvdf Command (m for help): n => Create Partition Partition type: p primary (0 primary, 0 extended, 4 free) e extended Command (m for help): p => Print partition Command (m for help): w => Write # mkfs -L projectA -t ext4 /dev/xvdf1 # Format Partition and create label # mkdir /mnt/ProjectA # mount /dev/xvdf1 /mnt/ProjectA/ # vi /etc/fstab LABEL=projectA /mnt/ProjectA/ ext4 defaults 0 0 # Add This Line umount /mnt/ProjectA/","title":"Create ext4 Filesystem"},{"location":"unix/commands/disks/#create-swap-partition","text":"Can use parted command # fdisk /dev/xvdf Welcome to fdisk (util-linux 2.31.1). Changes will remain in memory only, until you decide to write them. Be careful before using the write command. Command (m for help): p Disk /dev/xvdf: 8 GiB, 8589934592 bytes, 16777216 sectors Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disklabel type: dos Disk identifier: 0xaef5270b Device Boot Start End Sectors Size Id Type /dev/xvdf1 2048 4196351 4194304 2G 82 Linux swap / Solaris /dev/xvdf2 4196352 10487807 6291456 3G 83 Linux /dev/xvdf3 10487808 16777215 6289408 3G 5 Extended /dev/xvdf5 10489856 12587007 2097152 1G 83 Linux /dev/xvdf6 12589056 14686207 2097152 1G 83 Linux /dev/xvdf7 14688256 16777215 2088960 1020M 83 Linux Command (m for help): t Partition number (1-3,5-7, default 7): 1 Hex code (type L to list all codes): 82 Command (m for help): w # mkswap /dev/xvdf1 # swapon /dev/xvdf1 # to shutoff -> swapoff /dev/xvdf2 # free -m # vi /etc/fstab UUID=99fd52d5-e821-45a5-9366-30666046406f swap swap default 0 0","title":"Create Swap Partition"},{"location":"unix/commands/disks/#create-lvm-filesystem","text":"# fdisk /dev/xvdf Welcome to fdisk (util-linux 2.31.1). Changes will remain in memory only, until you decide to write them. Be careful before using the write command. Command (m for help): p Disk /dev/xvdf: 8 GiB, 8589934592 bytes, 16777216 sectors Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disklabel type: dos Disk identifier: 0xaef5270b Device Boot Start End Sectors Size Id Type /dev/xvdf1 2048 4196351 4194304 2G 82 Linux swap / Solaris /dev/xvdf2 4196352 10487807 6291456 3G 83 Linux /dev/xvdf3 10487808 16777215 6289408 3G 5 Extended /dev/xvdf5 10489856 12587007 2097152 1G 83 Linux /dev/xvdf6 12589056 14686207 2097152 1G 83 Linux /dev/xvdf7 14688256 16777215 2088960 1020M 83 Linux Command (m for help): t Partition number (1-3,5-7, default 7): 2 Hex code (type L to list all codes): 8e Changed type of partition 'Linux' to 'Linux LVM'. Command (m for help): w The partition table has been altered. Syncing disks. # fdisk /dev/xvdf Welcome to fdisk (util-linux 2.31.1). Changes will remain in memory only, until you decide to write them. Be careful before using the write command. Command (m for help): p Disk /dev/xvdf: 8 GiB, 8589934592 bytes, 16777216 sectors Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disklabel type: dos Disk identifier: 0xaef5270b Device Boot Start End Sectors Size Id Type /dev/xvdf1 2048 4196351 4194304 2G 82 Linux swap / Solaris /dev/xvdf2 4196352 10487807 6291456 3G 8e Linux LVM /dev/xvdf3 10487808 16777215 6289408 3G 5 Extended /dev/xvdf5 10489856 12587007 2097152 1G 83 Linux /dev/xvdf6 12589056 14686207 2097152 1G 83 Linux /dev/xvdf7 14688256 16777215 2088960 1020M 83 Linux Command (m for help): t Partition number (1-3,5-7, default 7): 5 Hex code (type L to list all codes): 8e Changed type of partition 'Linux' to 'Linux LVM'. Command (m for help): w The partition table has been altered. Syncing disks. # pvcreate /dev/xvdf2 Physical volume \"/dev/xvdf2\" successfully created. # pvcreate /dev/xvdf5 Physical volume \"/dev/xvdf5\" successfully created. # vgcreate VG1 /dev/xvdf2 /dev/xvdf5 Volume group \"VG1\" successfully created root@ip-172-31-81-196:~# vgdisplay /dev/VG1 --- Volume group --- VG Name VG1 System ID Format lvm2 Metadata Areas 2 Metadata Sequence No 1 VG Access read/write VG Status resizable MAX LV 0 Cur LV 0 Open LV 0 Max PV 0 Cur PV 2 Act PV 2 VG Size 3.99 GiB PE Size 4.00 MiB Total PE 1022 Alloc PE / Size 0 / 0 Free PE / Size 1022 / 3.99 GiB VG UUID ELopyA-2vai-XuiQ-vm7M-RF9q-k0ve-yUeXM6 # lvcreate VG1 -L +3.9G -n LV1 Rounding up size to full physical extent 3.90 GiB Logical volume \"LV1\" created. root@ip-172-31-81-196:~# lvdisplay --- Logical volume --- LV Path /dev/VG1/LV1 LV Name LV1 VG Name VG1 LV UUID Q0mXgw-q9E7-ncuH-Vv2t-NTqx-epn9-3EK3DH LV Write Access read/write LV Creation host, time ip-172-31-81-196, 2019-08-02 21:45:49 +0000 LV Status available # open 0 LV Size 3.90 GiB Current LE 999 Segments 2 Allocation inherit Read ahead sectors auto - currently set to 256 Block device 253:0 # mkfs.ext4 /dev/VG1/LV1 mke2fs 1.44.1 (24-Mar-2018) Creating filesystem with 1022976 4k blocks and 256000 inodes Filesystem UUID: 3cc6d97e-a315-4051-a572-16e06bf9c9f9 Superblock backups stored on blocks: 32768, 98304, 163840, 229376, 294912, 819200, 884736 Allocating group tables: done Writing inode tables: done Creating journal (16384 blocks): done Writing superblocks and filesystem accounting information: done root@ip-172-31-81-196:~# mkdir /mnt/LV1-mount root@ip-172-31-81-196:~# mount /dev/VG1/LV1 /mnt/LV1-mount root@ip-172-31-81-196:~# vi /etc/fstab /dev/VG1/LV1 /mnt/LV1-mount ext4 defaults 0 0 # Add This Line # Can edit first the /etc/fsatab file and after do mount -a (mount everything in /etc/fstab file) instead mount command","title":"Create LVM Filesystem"},{"location":"unix/commands/disks/#share-disk","text":"","title":"Share Disk"},{"location":"unix/commands/disks/#install-nfs","text":"yum install -y nfs-utils systemctl enable nfs systemctl start nfs","title":"Install NFS"},{"location":"unix/commands/disks/#master","text":"","title":"Master"},{"location":"unix/commands/disks/#configure-export","text":"/snapshots is a filestem from nfs type # vi /etc/exports /snapshots *(rw) => Add Line # exportfs /snapshots <world>","title":"Configure Export"},{"location":"unix/commands/disks/#enable-service","text":"firewall-cmd --add-service nfs --permanent firewall-cmd --permanent --add-service=rpc-bind firewall-cmd --permanent --add-service=mountd firewall-cmd --permanent --add-port=2049/tcp firewall-cmd --permanent --add-port=2049/udp firewall-cmd --reload","title":"Enable Service"},{"location":"unix/commands/disks/#slaves","text":"# vi /etc/fstab 10.240.100.18:/snapshots /elastic/snapshots nfs _netdev,rw 0 0 # mount -a # mount | grep elastic","title":"Slaves"},{"location":"unix/commands/filesystem/","text":"FileSystem Dir Function Extras /dev (udev) Device manager. Contain device files Config in /etc/udev /sys (sysfs) Virtual file system. Info about Hardware devices, drivers /proc (procfs)Similiar to sysfs, but with info about processes and system info Can be used to interface with the kernel. Change parameters on the fly File System space usage df -h Commands Dirs Create Multiple Dirs mkdir -p {networking,compute,storage} Multiple Files in Multiple Dirs touch {networking,compute,storage}/{main.tf,variables.tf,outputs.tf} Find sudo find / -type f -name .gitconfig Inodes Get File Inode ls -i /etc/passwd Find File by Inode find / -inum 55116 /etc/passwd Get Inodes Available df -i Disk Space du -h du -s # To sum the total du -s / du -h --max-depth=1 # Show the disk usage by folder, and not the sub dirs because of Depth = 1 Filesystem fsck (filesystem check) To check errors from filesystem Don't do in mounted filesystem sudo fsck /dev/sdb1 sudo umount /dev/sdb1 dumpe2fs Get info about filesystem sudo dumpe2fs -h /dev/sdb1 tune2fs To get info and tune filesystem tune2fs -l /dev/xvda1 Set Volume Name tune2fs -L Photos /dev/xvda1 Set mount counts will be filesystem checked tune2fs -c 10 /dev/xvda1 fuser Show which process is using the directory # fuser /mount/Photos /mount/Photos: 3157c # ps aux | grep 3157 -- Will see the process, probably /bin/bash # ps auxf -> Show which command executed and the login session called Disk Quotas # vi /etc/fstab LABEL=projectA /mnt/ProjectA/ ext4 defaults,usrquota 0 0 # mount -a # apt-get install quota # cd /mnt/ProjectA # quotacheck -avugc # Create filesystem to support quotas quotacheck: Your kernel probably supports journaled quota but you are not using it. Consider switching to journaled quota to avoid running quotacheck after an unclean shutdown. quotacheck: Scanning /dev/xvdf7 [/mnt/ProjectA] done quotacheck: Cannot stat old user quota file /mnt/ProjectA/aquota.user: No such file or directory. Usage will not be subtracted. quotacheck: Old group file name could not been determined. Usage will not be subtracted. quotacheck: Checked 3 directories and 0 files quotacheck: Old file not found. # edquota -u fsantos # To edit quotas to user # quotaon /mnt/Photos # Enable quotas # quota -v # To see quotas usage # sudo repquota /mnt/Photos # To see a resume from users","title":"Filesystem"},{"location":"unix/commands/filesystem/#filesystem","text":"Dir Function Extras /dev (udev) Device manager. Contain device files Config in /etc/udev /sys (sysfs) Virtual file system. Info about Hardware devices, drivers /proc (procfs)Similiar to sysfs, but with info about processes and system info Can be used to interface with the kernel. Change parameters on the fly File System space usage df -h","title":"FileSystem"},{"location":"unix/commands/filesystem/#commands","text":"","title":"Commands"},{"location":"unix/commands/filesystem/#dirs","text":"","title":"Dirs"},{"location":"unix/commands/filesystem/#create","text":"Multiple Dirs mkdir -p {networking,compute,storage} Multiple Files in Multiple Dirs touch {networking,compute,storage}/{main.tf,variables.tf,outputs.tf}","title":"Create"},{"location":"unix/commands/filesystem/#find","text":"sudo find / -type f -name .gitconfig","title":"Find"},{"location":"unix/commands/filesystem/#inodes","text":"Get File Inode ls -i /etc/passwd Find File by Inode find / -inum 55116 /etc/passwd Get Inodes Available df -i","title":"Inodes"},{"location":"unix/commands/filesystem/#disk-space","text":"du -h du -s # To sum the total du -s / du -h --max-depth=1 # Show the disk usage by folder, and not the sub dirs because of Depth = 1","title":"Disk Space"},{"location":"unix/commands/filesystem/#filesystem_1","text":"","title":"Filesystem"},{"location":"unix/commands/filesystem/#fsck-filesystem-check","text":"To check errors from filesystem Don't do in mounted filesystem sudo fsck /dev/sdb1 sudo umount /dev/sdb1","title":"fsck (filesystem check)"},{"location":"unix/commands/filesystem/#dumpe2fs","text":"Get info about filesystem sudo dumpe2fs -h /dev/sdb1","title":"dumpe2fs"},{"location":"unix/commands/filesystem/#tune2fs","text":"To get info and tune filesystem tune2fs -l /dev/xvda1 Set Volume Name tune2fs -L Photos /dev/xvda1 Set mount counts will be filesystem checked tune2fs -c 10 /dev/xvda1","title":"tune2fs"},{"location":"unix/commands/filesystem/#fuser","text":"Show which process is using the directory # fuser /mount/Photos /mount/Photos: 3157c # ps aux | grep 3157 -- Will see the process, probably /bin/bash # ps auxf -> Show which command executed and the login session called","title":"fuser"},{"location":"unix/commands/filesystem/#disk-quotas","text":"# vi /etc/fstab LABEL=projectA /mnt/ProjectA/ ext4 defaults,usrquota 0 0 # mount -a # apt-get install quota # cd /mnt/ProjectA # quotacheck -avugc # Create filesystem to support quotas quotacheck: Your kernel probably supports journaled quota but you are not using it. Consider switching to journaled quota to avoid running quotacheck after an unclean shutdown. quotacheck: Scanning /dev/xvdf7 [/mnt/ProjectA] done quotacheck: Cannot stat old user quota file /mnt/ProjectA/aquota.user: No such file or directory. Usage will not be subtracted. quotacheck: Old group file name could not been determined. Usage will not be subtracted. quotacheck: Checked 3 directories and 0 files quotacheck: Old file not found. # edquota -u fsantos # To edit quotas to user # quotaon /mnt/Photos # Enable quotas # quota -v # To see quotas usage # sudo repquota /mnt/Photos # To see a resume from users","title":"Disk Quotas"},{"location":"unix/commands/kernel/","text":"Kernel Modules # To view who use the modules lsmod # To remove sudo rmmod video # To enable sudo modprobe video Libs Shared # Get Shared libs location cat /etc/ld.so.conf # To load new lib ldconfig # Change Library Path temporary export LD_LIBRARY_PATH=/home/nick/lib # Print shared libs from app ldd /bin/ls Hardware PCI Devices # To list pci Devices lspci lspci -v lspci -vvv","title":"Kernel"},{"location":"unix/commands/kernel/#kernel-modules","text":"# To view who use the modules lsmod # To remove sudo rmmod video # To enable sudo modprobe video","title":"Kernel Modules"},{"location":"unix/commands/kernel/#libs","text":"","title":"Libs"},{"location":"unix/commands/kernel/#shared","text":"# Get Shared libs location cat /etc/ld.so.conf # To load new lib ldconfig # Change Library Path temporary export LD_LIBRARY_PATH=/home/nick/lib # Print shared libs from app ldd /bin/ls","title":"Shared"},{"location":"unix/commands/kernel/#hardware","text":"","title":"Hardware"},{"location":"unix/commands/kernel/#pci-devices","text":"# To list pci Devices lspci lspci -v lspci -vvv","title":"PCI Devices"},{"location":"unix/commands/logging/","text":"Syslog Config Files cd /etc/rsyslog.d/ Rotate Files Conf vi /etc/logrotate.conf Journalctl **Log For Services journalctl # All journalctl -b # Last Boot journalctl -b 1 # Before Last Boot journalctl --since \"2 days ago\" journalctl -u kubelet.service vi /etc/system.d/journald.conf # Config Files","title":"Logging"},{"location":"unix/commands/logging/#syslog","text":"","title":"Syslog"},{"location":"unix/commands/logging/#config-files","text":"cd /etc/rsyslog.d/","title":"Config Files"},{"location":"unix/commands/logging/#rotate-files-conf","text":"vi /etc/logrotate.conf","title":"Rotate Files Conf"},{"location":"unix/commands/logging/#journalctl","text":"**Log For Services journalctl # All journalctl -b # Last Boot journalctl -b 1 # Before Last Boot journalctl --since \"2 days ago\" journalctl -u kubelet.service vi /etc/system.d/journald.conf # Config Files","title":"Journalctl"},{"location":"unix/commands/networking/","text":"Config ifconfig ip addr ifconfig ifconfig -a ifdown enp0s3 ifup enp0s3 ifconfig enp0s3 192.168.0.150/24 # Not Permanent Add Secondary IP Link ifconfig eth0:1 172.31.81.196 netmask 255.255.240.0 up # Not Permanent ip ip a ip addr show Remove Secondary Ip ip addr del 172.31.81.196/20 dev eth0:1 # Not Permanent route route route -n route add default gw 192.168.0.254 Dns cat /etc/hosts cat /etc/nsswitch.conf # show how priority to will resolve dns cat /etc/resolv.conf cat /etc/dhcp/dhclient.conf sudo service networking restart File cat /etc/network/interfaces Connectivity Netstat $ sudo netstat -nl -p tcp | grep 8123 $ sudo netstat -nl -p tcp | head Get open ports nmap localhost netstat -at SS ss -an | grep -i listen Who listen on Port sudo lsof -i :8000 Test Remote Connection to port nc -v 10.240.100.18 2049 netcat -l 12345 # To listen a Port Get Ports than services are listen cat /etc/services DNS host google.com dig google.com","title":"Networking"},{"location":"unix/commands/networking/#config","text":"","title":"Config"},{"location":"unix/commands/networking/#ifconfig","text":"ip addr ifconfig ifconfig -a ifdown enp0s3 ifup enp0s3 ifconfig enp0s3 192.168.0.150/24 # Not Permanent","title":"ifconfig"},{"location":"unix/commands/networking/#add-secondary-ip","text":"Link ifconfig eth0:1 172.31.81.196 netmask 255.255.240.0 up # Not Permanent","title":"Add Secondary IP"},{"location":"unix/commands/networking/#ip","text":"ip a ip addr show","title":"ip"},{"location":"unix/commands/networking/#remove-secondary-ip","text":"ip addr del 172.31.81.196/20 dev eth0:1 # Not Permanent","title":"Remove Secondary Ip"},{"location":"unix/commands/networking/#route","text":"route route -n route add default gw 192.168.0.254","title":"route"},{"location":"unix/commands/networking/#dns","text":"cat /etc/hosts cat /etc/nsswitch.conf # show how priority to will resolve dns cat /etc/resolv.conf cat /etc/dhcp/dhclient.conf sudo service networking restart","title":"Dns"},{"location":"unix/commands/networking/#file","text":"cat /etc/network/interfaces","title":"File"},{"location":"unix/commands/networking/#connectivity","text":"","title":"Connectivity"},{"location":"unix/commands/networking/#netstat","text":"$ sudo netstat -nl -p tcp | grep 8123 $ sudo netstat -nl -p tcp | head","title":"Netstat"},{"location":"unix/commands/networking/#get-open-ports","text":"nmap localhost netstat -at","title":"Get open ports"},{"location":"unix/commands/networking/#ss","text":"ss -an | grep -i listen","title":"SS"},{"location":"unix/commands/networking/#who-listen-on-port","text":"sudo lsof -i :8000","title":"Who listen on Port"},{"location":"unix/commands/networking/#test-remote-connection-to-port","text":"nc -v 10.240.100.18 2049 netcat -l 12345 # To listen a Port","title":"Test Remote Connection to port"},{"location":"unix/commands/networking/#get-ports-than-services-are-listen","text":"cat /etc/services","title":"Get Ports than services are listen"},{"location":"unix/commands/networking/#dns_1","text":"host google.com dig google.com","title":"DNS"},{"location":"unix/commands/security/","text":"Security Host cat /etc/hosts.allow # Hosts allowed to access cat /etc/hosts.deny # Hosts not allowed to access Nologin touch /etc/nologin # Denies login to all users (except root). Need remove the file","title":"Security"},{"location":"unix/commands/security/#security","text":"","title":"Security"},{"location":"unix/commands/security/#host","text":"cat /etc/hosts.allow # Hosts allowed to access cat /etc/hosts.deny # Hosts not allowed to access","title":"Host"},{"location":"unix/commands/security/#nologin","text":"touch /etc/nologin # Denies login to all users (except root). Need remove the file","title":"Nologin"},{"location":"unix/os/archlinux/","text":"Packages Packages Update Package sudo pacman -U <link - see above> Update corrupted or invalid database pacman-key --delete 91FFE0700E80619CEB73235CA88E23E377514E00 pacman-key --populate archlinux Resolve ICU Package Problem Link Download and Install old \"icu\" package; wget https://archive.archlinux.org/packages/i/icu/icu-62.1-1-x86_64.pkg.tar.xz sudo pacman -U icu-62.1-1-x86_64.pkg.tar.xz Copy all \"icu\" files to a backup directory; sudo mkdir /usr/lib/backup sudo cp -r /usr/lib/libicu* /usr/lib/backup/ Install new version of \"icu\" again; sudo pacman -U /var/cache/pacman/pkg/icu-62.1-1-x86_64.pkg.tar.xz Copy this three files back to /var/lib/ direcotry; sudo cp /var/lib/libicui18n.so.61 /usr/lib/ sudo cp /var/lib/libicuuc.so.61 /usr/lib/ sudo cp /var/lib/libicudata.so.61 /usr/lib/ You can now cleanup backup files; sudo rm -rf /var/lib/backup","title":"Archlinux"},{"location":"unix/os/archlinux/#packages","text":"Packages","title":"Packages"},{"location":"unix/os/archlinux/#update-package","text":"sudo pacman -U <link - see above>","title":"Update Package"},{"location":"unix/os/archlinux/#update-corrupted-or-invalid-database","text":"pacman-key --delete 91FFE0700E80619CEB73235CA88E23E377514E00 pacman-key --populate archlinux","title":"Update corrupted or invalid database"},{"location":"unix/os/archlinux/#resolve-icu-package-problem","text":"Link Download and Install old \"icu\" package; wget https://archive.archlinux.org/packages/i/icu/icu-62.1-1-x86_64.pkg.tar.xz sudo pacman -U icu-62.1-1-x86_64.pkg.tar.xz Copy all \"icu\" files to a backup directory; sudo mkdir /usr/lib/backup sudo cp -r /usr/lib/libicu* /usr/lib/backup/ Install new version of \"icu\" again; sudo pacman -U /var/cache/pacman/pkg/icu-62.1-1-x86_64.pkg.tar.xz Copy this three files back to /var/lib/ direcotry; sudo cp /var/lib/libicui18n.so.61 /usr/lib/ sudo cp /var/lib/libicuuc.so.61 /usr/lib/ sudo cp /var/lib/libicudata.so.61 /usr/lib/ You can now cleanup backup files; sudo rm -rf /var/lib/backup","title":"Resolve ICU Package Problem"},{"location":"unix/os/debian/","text":"Know Errors (Ubuntu) Unable to lock the administration directory Desc: Unable to lock the administration directory (/var/lib/dpkg/) is another process using it? Solution sudo rm /var/lib/apt/lists/lock dpkg # To list all installed packages dpkg -l | less # To install package sudo dpkg -i dlocate_1.02+nmu3_all.deb # To Remove sudo dpkg --purge dlocate Apt # Sources file cat /etc/apt/sources.list sudo apt-get update sudo apt-get upgrade sudo apt-get dist-upgrade # Better # To Get dependences apt-cache depends apache2 | less","title":"Debian"},{"location":"unix/os/debian/#know-errors-ubuntu","text":"","title":"Know Errors (Ubuntu)"},{"location":"unix/os/debian/#unable-to-lock-the-administration-directory","text":"Desc: Unable to lock the administration directory (/var/lib/dpkg/) is another process using it? Solution sudo rm /var/lib/apt/lists/lock","title":"Unable to lock the administration directory"},{"location":"unix/os/debian/#dpkg","text":"# To list all installed packages dpkg -l | less # To install package sudo dpkg -i dlocate_1.02+nmu3_all.deb # To Remove sudo dpkg --purge dlocate","title":"dpkg"},{"location":"unix/os/debian/#apt","text":"# Sources file cat /etc/apt/sources.list sudo apt-get update sudo apt-get upgrade sudo apt-get dist-upgrade # Better # To Get dependences apt-cache depends apache2 | less","title":"Apt"},{"location":"unix/os/redhat/","text":"Recover Root Password Na console send ctrl-alt-del press \"e\" => TO Edit Na linha linux16 -- No final da linha adicionar rd.break press \"ctrl-x\" mount -o remount,rw /sysroot cd /sysroot chroot . touch .autorelabel passwd teste123ibm4 ctrl d ctrl d Permit SSH Root Login vi /etc/ssh/sshd_config # Comment PasswordAuthentication no # Descomment PasswordAuthentication yes systemctl restart sshd Configure Network Interface vi /etc/sysconfig/network-scripts/ifcfg-eth0 IPADDR=172.16.1.180 GATEWAY=172.16.1.16 DNS1=172.16.1.112 DNS2=172.16.1.119 systemctl restart network Package Manager RPM sudo rpm -i wget-xxxxxx.rpm # To see which lib file belongs rpm -qf /etc/protocols # To see if some file is missing from lib sudo rpm --verify setup sudo rpm -Va # To verify entire machine YUM # Config file cat /etc/yum.conf # Repos dir cd /etc/yum.repos.d sudo yum update # To download but not install sudo yum install --downloadonly --downloaddir=/tmp wget sudo yum remove wget","title":"Redhat"},{"location":"unix/os/redhat/#recover-root-password","text":"Na console send ctrl-alt-del press \"e\" => TO Edit Na linha linux16 -- No final da linha adicionar rd.break press \"ctrl-x\" mount -o remount,rw /sysroot cd /sysroot chroot . touch .autorelabel passwd teste123ibm4 ctrl d ctrl d","title":"Recover Root Password"},{"location":"unix/os/redhat/#permit-ssh-root-login","text":"vi /etc/ssh/sshd_config # Comment PasswordAuthentication no # Descomment PasswordAuthentication yes systemctl restart sshd","title":"Permit SSH Root Login"},{"location":"unix/os/redhat/#configure-network-interface","text":"vi /etc/sysconfig/network-scripts/ifcfg-eth0 IPADDR=172.16.1.180 GATEWAY=172.16.1.16 DNS1=172.16.1.112 DNS2=172.16.1.119 systemctl restart network","title":"Configure Network Interface"},{"location":"unix/os/redhat/#package-manager","text":"","title":"Package Manager"},{"location":"unix/os/redhat/#rpm","text":"sudo rpm -i wget-xxxxxx.rpm # To see which lib file belongs rpm -qf /etc/protocols # To see if some file is missing from lib sudo rpm --verify setup sudo rpm -Va # To verify entire machine","title":"RPM"},{"location":"unix/os/redhat/#yum","text":"# Config file cat /etc/yum.conf # Repos dir cd /etc/yum.repos.d sudo yum update # To download but not install sudo yum install --downloadonly --downloaddir=/tmp wget sudo yum remove wget","title":"YUM"},{"location":"unix/software/mail/postfix/","text":"Install sudo apt-get install postfix mutt Aliases # vi /etc/aliases cloudgurus: root, guru Log cat /var/log/mail.log","title":"Postfix"},{"location":"unix/software/mail/postfix/#install","text":"sudo apt-get install postfix mutt","title":"Install"},{"location":"unix/software/mail/postfix/#aliases","text":"# vi /etc/aliases cloudgurus: root, guru","title":"Aliases"},{"location":"unix/software/mail/postfix/#log","text":"cat /var/log/mail.log","title":"Log"},{"location":"unix/software/programming/php/","text":"Install Lamp Server https://www.howtoforge.com/tutorial/centos-lamp-server-apache-mysql-php/ Ioncube Loader https://www.howtoforge.com/tutorial/how-to-install-ioncube-loader/ Cli Get Modules php -m","title":"PHP"},{"location":"unix/software/programming/php/#install","text":"","title":"Install"},{"location":"unix/software/programming/php/#lamp-server","text":"https://www.howtoforge.com/tutorial/centos-lamp-server-apache-mysql-php/","title":"Lamp Server"},{"location":"unix/software/programming/php/#ioncube-loader","text":"https://www.howtoforge.com/tutorial/how-to-install-ioncube-loader/","title":"Ioncube Loader"},{"location":"unix/software/programming/php/#cli","text":"","title":"Cli"},{"location":"unix/software/programming/php/#get-modules","text":"php -m","title":"Get Modules"},{"location":"unix/software/virtualization/virsh/","text":"VM Snapshot $ ssh -l rgameiro 10.242.12.23 $ virsh list --all Id Name State ---------------------------------------------------- 1 bm02vsc01 running 2 bm02alinternal01 running 3 architect running 4 bm02ifwinternal01 running 5 bm02vsd01 running 6 bm02sfinternal02 running 7 bm02acinternal01 running 8 bm02dirinternal01 running - bm02nes01 shut off $ virsh destroy bm02sfinternal02 $ virsh dumpxml bm02sfinternal02 # Find Disk File <domain type='kvm'> <name>bm02sfinternal02</name> <uuid>af7d246d-4578-4660-96fa-ac40c87c24eb</uuid> <memory unit='KiB'>2097152</memory> <currentMemory unit='KiB'>2097152</currentMemory> <vcpu placement='static'>4</vcpu> <os> <type arch='x86_64' machine='pc-i440fx-rhel7.3.0'>hvm</type> <boot dev='hd'/> </os> <features> <acpi/> <apic/> <vmport state='off'/> </features> <cpu mode='host-model' check='partial'> <model fallback='allow'/> </cpu> <clock offset='utc'> <timer name='rtc' tickpolicy='catchup'/> <timer name='pit' tickpolicy='delay'/> <timer name='hpet' present='no'/> </clock> <on_poweroff>destroy</on_poweroff> <on_reboot>restart</on_reboot> <on_crash>restart</on_crash> <pm> <suspend-to-mem enabled='no'/> <suspend-to-disk enabled='no'/> </pm> <devices> <emulator>/usr/libexec/qemu-kvm</emulator> <disk type='file' device='disk'> <driver name='qemu' type='qcow2' cache='none' io='native'/> <source file='/var/lib/libvirt/images/bm02sfinternal02.qcow2'/> <target dev='vda' bus='virtio'/> <address type='pci' domain='0x0000' bus='0x00' slot='0x06' function='0x0'/> </disk> <disk type='file' device='cdrom'> <driver name='qemu' type='raw'/> <target dev='hda' bus='ide'/> <readonly/> <address type='drive' controller='0' bus='0' target='0' unit='0'/> </disk> <controller type='usb' index='0' model='ich9-ehci1'> <address type='pci' domain='0x0000' bus='0x00' slot='0x05' function='0x7'/> </controller> <controller type='usb' index='0' model='ich9-uhci1'> <master startport='0'/> <address type='pci' domain='0x0000' bus='0x00' slot='0x05' function='0x0' multifunction='on'/> </controller> <controller type='usb' index='0' model='ich9-uhci2'> <master startport='2'/> <address type='pci' domain='0x0000' bus='0x00' slot='0x05' function='0x1'/> </controller> <controller type='usb' index='0' model='ich9-uhci3'> <master startport='4'/> <address type='pci' domain='0x0000' bus='0x00' slot='0x05' function='0x2'/> </controller> <controller type='pci' index='0' model='pci-root'/> <controller type='ide' index='0'> <address type='pci' domain='0x0000' bus='0x00' slot='0x01' function='0x1'/> </controller> <controller type='virtio-serial' index='0'> <address type='pci' domain='0x0000' bus='0x00' slot='0x04' function='0x0'/> </controller> <interface type='bridge'> <mac address='52:54:00:84:7e:d0'/> <source bridge='br100'/> <model type='virtio'/> <address type='pci' domain='0x0000' bus='0x00' slot='0x03' function='0x0'/> </interface> <serial type='pty'> <target type='isa-serial' port='0'> <model name='isa-serial'/> </target> </serial> <console type='pty'> <target type='serial' port='0'/> </console> <channel type='unix'> <target type='virtio' name='org.qemu.guest_agent.0'/> <address type='virtio-serial' controller='0' bus='0' port='1'/> </channel> <channel type='spicevmc'> <target type='virtio' name='com.redhat.spice.0'/> <address type='virtio-serial' controller='0' bus='0' port='2'/> </channel> <input type='tablet' bus='usb'> <address type='usb' bus='0' port='1'/> </input> <input type='mouse' bus='ps2'/> <input type='keyboard' bus='ps2'/> <graphics type='spice' autoport='yes'> <listen type='address'/> </graphics> <video> <model type='qxl' ram='65536' vram='65536' vgamem='16384' heads='1' primary='yes'/> <address type='pci' domain='0x0000' bus='0x00' slot='0x02' function='0x0'/> </video> <redirdev bus='usb' type='spicevmc'> <address type='usb' bus='0' port='2'/> </redirdev> <redirdev bus='usb' type='spicevmc'> <address type='usb' bus='0' port='3'/> </redirdev> <memballoon model='virtio'> <address type='pci' domain='0x0000' bus='0x00' slot='0x07' function='0x0'/> </memballoon> </devices> </domain> $ ls -la /var/lib/libvirt/images/bm02sfinternal02.qcow2 $ df -B 1g # Ensure we have space to copy disk $ cp /var/lib/libvirt/images/bm02sfinternal02.qcow2 /var/lib/libvirt/images/bm02sfinternal02-pre-php-upgrade.qcow2 $ bg # Por o Processo em Brackground $ ls -la /var/lib/libvirt/images/bm02sfinternal02-pre-php-upgrade.qcow2 rw------- 1 root root 17607884800 Oct 30 08:21 /var/lib/libvirt/images/bm02sfinternal02-pre-php-upgrade.qcow2 $ ls -la /var/lib/libvirt/images/bm02sfinternal02-pre-php-upgrade.qcow2 # Terminou [1]+ Done cp -i /var/lib/libvirt/images/bm02sfinternal02.qcow2 /var/lib/libvirt/images/bm02sfinternal02-pre-php-upgrade.qcow2 $ ls -la /var/lib/libvirt/images/bm02sfinternal02* $ virsh start bm02sfinternal02","title":"Virsh"},{"location":"unix/software/virtualization/virsh/#vm","text":"","title":"VM"},{"location":"unix/software/virtualization/virsh/#snapshot","text":"$ ssh -l rgameiro 10.242.12.23 $ virsh list --all Id Name State ---------------------------------------------------- 1 bm02vsc01 running 2 bm02alinternal01 running 3 architect running 4 bm02ifwinternal01 running 5 bm02vsd01 running 6 bm02sfinternal02 running 7 bm02acinternal01 running 8 bm02dirinternal01 running - bm02nes01 shut off $ virsh destroy bm02sfinternal02 $ virsh dumpxml bm02sfinternal02 # Find Disk File <domain type='kvm'> <name>bm02sfinternal02</name> <uuid>af7d246d-4578-4660-96fa-ac40c87c24eb</uuid> <memory unit='KiB'>2097152</memory> <currentMemory unit='KiB'>2097152</currentMemory> <vcpu placement='static'>4</vcpu> <os> <type arch='x86_64' machine='pc-i440fx-rhel7.3.0'>hvm</type> <boot dev='hd'/> </os> <features> <acpi/> <apic/> <vmport state='off'/> </features> <cpu mode='host-model' check='partial'> <model fallback='allow'/> </cpu> <clock offset='utc'> <timer name='rtc' tickpolicy='catchup'/> <timer name='pit' tickpolicy='delay'/> <timer name='hpet' present='no'/> </clock> <on_poweroff>destroy</on_poweroff> <on_reboot>restart</on_reboot> <on_crash>restart</on_crash> <pm> <suspend-to-mem enabled='no'/> <suspend-to-disk enabled='no'/> </pm> <devices> <emulator>/usr/libexec/qemu-kvm</emulator> <disk type='file' device='disk'> <driver name='qemu' type='qcow2' cache='none' io='native'/> <source file='/var/lib/libvirt/images/bm02sfinternal02.qcow2'/> <target dev='vda' bus='virtio'/> <address type='pci' domain='0x0000' bus='0x00' slot='0x06' function='0x0'/> </disk> <disk type='file' device='cdrom'> <driver name='qemu' type='raw'/> <target dev='hda' bus='ide'/> <readonly/> <address type='drive' controller='0' bus='0' target='0' unit='0'/> </disk> <controller type='usb' index='0' model='ich9-ehci1'> <address type='pci' domain='0x0000' bus='0x00' slot='0x05' function='0x7'/> </controller> <controller type='usb' index='0' model='ich9-uhci1'> <master startport='0'/> <address type='pci' domain='0x0000' bus='0x00' slot='0x05' function='0x0' multifunction='on'/> </controller> <controller type='usb' index='0' model='ich9-uhci2'> <master startport='2'/> <address type='pci' domain='0x0000' bus='0x00' slot='0x05' function='0x1'/> </controller> <controller type='usb' index='0' model='ich9-uhci3'> <master startport='4'/> <address type='pci' domain='0x0000' bus='0x00' slot='0x05' function='0x2'/> </controller> <controller type='pci' index='0' model='pci-root'/> <controller type='ide' index='0'> <address type='pci' domain='0x0000' bus='0x00' slot='0x01' function='0x1'/> </controller> <controller type='virtio-serial' index='0'> <address type='pci' domain='0x0000' bus='0x00' slot='0x04' function='0x0'/> </controller> <interface type='bridge'> <mac address='52:54:00:84:7e:d0'/> <source bridge='br100'/> <model type='virtio'/> <address type='pci' domain='0x0000' bus='0x00' slot='0x03' function='0x0'/> </interface> <serial type='pty'> <target type='isa-serial' port='0'> <model name='isa-serial'/> </target> </serial> <console type='pty'> <target type='serial' port='0'/> </console> <channel type='unix'> <target type='virtio' name='org.qemu.guest_agent.0'/> <address type='virtio-serial' controller='0' bus='0' port='1'/> </channel> <channel type='spicevmc'> <target type='virtio' name='com.redhat.spice.0'/> <address type='virtio-serial' controller='0' bus='0' port='2'/> </channel> <input type='tablet' bus='usb'> <address type='usb' bus='0' port='1'/> </input> <input type='mouse' bus='ps2'/> <input type='keyboard' bus='ps2'/> <graphics type='spice' autoport='yes'> <listen type='address'/> </graphics> <video> <model type='qxl' ram='65536' vram='65536' vgamem='16384' heads='1' primary='yes'/> <address type='pci' domain='0x0000' bus='0x00' slot='0x02' function='0x0'/> </video> <redirdev bus='usb' type='spicevmc'> <address type='usb' bus='0' port='2'/> </redirdev> <redirdev bus='usb' type='spicevmc'> <address type='usb' bus='0' port='3'/> </redirdev> <memballoon model='virtio'> <address type='pci' domain='0x0000' bus='0x00' slot='0x07' function='0x0'/> </memballoon> </devices> </domain> $ ls -la /var/lib/libvirt/images/bm02sfinternal02.qcow2 $ df -B 1g # Ensure we have space to copy disk $ cp /var/lib/libvirt/images/bm02sfinternal02.qcow2 /var/lib/libvirt/images/bm02sfinternal02-pre-php-upgrade.qcow2 $ bg # Por o Processo em Brackground $ ls -la /var/lib/libvirt/images/bm02sfinternal02-pre-php-upgrade.qcow2 rw------- 1 root root 17607884800 Oct 30 08:21 /var/lib/libvirt/images/bm02sfinternal02-pre-php-upgrade.qcow2 $ ls -la /var/lib/libvirt/images/bm02sfinternal02-pre-php-upgrade.qcow2 # Terminou [1]+ Done cp -i /var/lib/libvirt/images/bm02sfinternal02.qcow2 /var/lib/libvirt/images/bm02sfinternal02-pre-php-upgrade.qcow2 $ ls -la /var/lib/libvirt/images/bm02sfinternal02* $ virsh start bm02sfinternal02","title":"Snapshot"}]}