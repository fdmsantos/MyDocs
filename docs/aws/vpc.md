# Bastion Host

## High Availability

* Create 2 bastion hosts in different subnets. Create dns entry in Route53 which uses round robin dns and points to each instance. Tell your sysdamins to connect using the new dns entry
* EC2 Auto-recovery - If fails, will be recreate
* Autoscaling group of MAX =1 and MIN = 1. So if the bastion fails it is recreated automatically

# VPC Flow Logs

## Traffic Not Logged

* Traffic generated by instances when contact the Amazon DNS server (if use own dns, so all that traffic is logged)
* Traffic generated by a windows instance for Amazon windows license activation
* Traffic to and from 169.254.169.254 for instance metadata
* DHCP traffic
* Traffic to the reserved IP address for the default VPC router

# Troubleshooting

## Instances cannot communicate

**If instances in subnets cannot communicate with one another**

* Verify that it is a network issue, not an instance issue
* Check network ACLs
* If enable, check VPC flow Logs

## Nat Configuration

* Nat Instance and Nat Gateway - Check Route table Association
* Nat Instance - Check to see if the source/Dest check is disabled
* Ensure that NAT has masquerade configured, Restart NAT, check the inbound security Group rules
If you cannot reach resources in a peered network:

## Peering request approval

* Route table configuration
* Check network ACLs: are you forbidding all external traffic
* Check security Group configurations on resources
* Use Cidr block rules in VPC A to allow Access from VPC B
* If you are not seeing network traffic flow on the AWS side of your VPN connection to your Amazon VPC. Turn on route propagation in the Amazon VPC’s main routing table.